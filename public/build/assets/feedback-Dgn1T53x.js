import{u as M,r as l,j as e,H as T,b as h}from"./app-_wj1wiEc.js";import{A as E}from"./app-layout-BSN3Q_UY.js";import{I as O}from"./input-CaSbsQoB.js";import{B as n}from"./button-HZSfloRH.js";import{C as P,a as $}from"./card-DUg4c0sP.js";import{D as u,e as z,a as g,b as j,c as b}from"./dialog-BHDE3h_S.js";import{L as v}from"./label-DuuBaXdl.js";import{F as H,z as d}from"./index-9aUBe4GY.js";import"./app-DgE45SX0.js";import"./utils-csTuJWuA.js";import"./clsx-B-dksMZM.js";import"./index-DVkLe2dy.js";import"./index-DlLLoGOC.js";import"./index-Dl6FYVux.js";import"./index-CObx42Nt.js";import"./x-cF_pgnf8.js";import"./createLucideIcon-Dk2zpREm.js";import"./index-BRMnPjnz.js";import"./chevron-down-Ciywszaj.js";import"./index-CRvzyME4.js";import"./index-CDy59-5j.js";import"./index-CMWG4mbA.js";import"./log-out-CytyyNiJ.js";import"./users-CzPkGoWA.js";import"./map-pin-K0z2MPXY.js";import"./file-text-ZNTU_lRQ.js";import"./clipboard-list-iHk9S1ba.js";import"./settings-B87Gxw1-.js";function he(){const{feedbacks:y}=M().props,[i,w]=l.useState(""),[N,c]=l.useState(!1),[f,o]=l.useState(!1),[t,C]=l.useState(null),[a,x]=l.useState({type:"",message:""}),k=()=>x({type:"",message:""}),S=()=>{h.post("/admin/feedback",a,{onSuccess:()=>{d.success("Feedback added!"),k(),o(!1)},onError:()=>d.error("Failed to add feedback")})},F=(s,p)=>{h.patch(`/feedback/${s}`,{status:p},{onSuccess:()=>d.success("Status updated!"),onError:()=>d.error("Failed to update status")})},m={feedback:"bg-blue-100 text-blue-700",suggestion:"bg-green-100 text-green-700",complaint:"bg-red-100 text-red-700"},D={pending:"bg-yellow-100 text-yellow-800",reviewed:"bg-blue-100 text-blue-800",resolved:"bg-green-100 text-green-800"},r=y.filter(s=>s.message.toLowerCase().includes(i.toLowerCase())||s.resident?.name.toLowerCase().includes(i.toLowerCase())),L=r.filter(s=>s.status==="pending").length,A=r.filter(s=>s.status==="reviewed").length,R=r.filter(s=>s.status==="resolved").length;return e.jsxs(E,{breadcrumbs:[{title:"Feedback",href:"#"}],children:[e.jsx(T,{title:"Feedback Management"}),e.jsx(H,{position:"top-right"}),e.jsxs("div",{className:"mb-10 bg-gradient-to-r from-green-700 to-green-500 text-white p-8 rounded-xl shadow-xl",children:[e.jsx("h1",{className:"text-4xl font-extrabold",children:"Feedback Management"}),e.jsx("p",{className:"opacity-90 text-sm",children:"Review and manage resident concerns."})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center bg-white px-5 py-4 rounded-xl shadow border",children:[e.jsx(O,{placeholder:"Search feedback...",className:"max-w-md",value:i,onChange:s=>w(s.target.value)}),e.jsxs(u,{open:f,onOpenChange:o,children:[e.jsx(z,{asChild:!0,children:e.jsx(n,{className:"bg-blue-600 text-white hover:bg-blue-700",children:"+ Add Feedback"})}),e.jsxs(g,{className:"sm:max-w-lg",children:[e.jsx(j,{children:e.jsx(b,{children:"Create Feedback"})}),e.jsxs("div",{className:"space-y-4 mt-2",children:[e.jsxs("div",{children:[e.jsx(v,{children:"Type"}),e.jsxs("select",{className:"border rounded w-full p-2",value:a.type,onChange:s=>x({...a,type:s.target.value}),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"feedback",children:"Feedback"}),e.jsx("option",{value:"suggestion",children:"Suggestion"}),e.jsx("option",{value:"complaint",children:"Complaint"})]})]}),e.jsxs("div",{children:[e.jsx(v,{children:"Message"}),e.jsx("textarea",{rows:3,className:"border rounded w-full p-2",value:a.message,onChange:s=>x({...a,message:s.target.value})})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(n,{variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsx(n,{onClick:S,children:"Submit"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-yellow-100 text-yellow-800 p-4 rounded-xl shadow text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:L}),"Pending"]}),e.jsxs("div",{className:"bg-blue-100 text-blue-800 p-4 rounded-xl shadow text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:A}),"Reviewed"]}),e.jsxs("div",{className:"bg-green-100 text-green-800 p-4 rounded-xl shadow text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:R}),"Resolved"]})]}),e.jsx(P,{className:"shadow-xl rounded-2xl border overflow-x-auto",children:e.jsx($,{className:"p-0",children:e.jsxs("table",{className:"w-full text-sm text-left table-fixed min-w-[900px]",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 uppercase text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 w-40",children:"Resident"}),e.jsx("th",{className:"px-6 py-3 w-32",children:"Type"}),e.jsx("th",{className:"px-6 py-3",children:"Message"}),e.jsx("th",{className:"px-6 py-3 w-32 text-center",children:"Status"}),e.jsx("th",{className:"px-6 py-3 w-40",children:"Date"}),e.jsx("th",{className:"px-6 py-3 w-24 text-center",children:"Actions"})]})}),e.jsx("tbody",{children:r.length>0?r.map(s=>e.jsxs("tr",{className:"border-b hover:bg-gray-50 transition",children:[e.jsx("td",{className:"px-6 py-4 font-medium",children:s.resident?.name}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${m[s.type]}`,children:s.type})}),e.jsx("td",{className:"px-6 py-4 truncate max-w-xs",children:s.message}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsxs("select",{className:`px-2 py-1 rounded text-xs font-semibold cursor-pointer ${D[s.status]}`,value:s.status,onChange:p=>F(s.id,p.target.value),children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"reviewed",children:"Reviewed"}),e.jsx("option",{value:"resolved",children:"Resolved"})]})}),e.jsx("td",{className:"px-6 py-4",children:new Date(s.created_at).toLocaleString()}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx(n,{size:"sm",variant:"secondary",onClick:()=>{C(s),c(!0)},children:"View"})})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-8 text-gray-500",children:"No feedback found."})})})]})})})]}),e.jsx(u,{open:N,onOpenChange:c,children:e.jsxs(g,{className:"sm:max-w-md",children:[e.jsx(j,{children:e.jsx(b,{children:"Feedback Details"})}),t&&e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"From:"})," ",t.resident?.name]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Type:"}),e.jsx("span",{className:`ml-2 px-2 py-1 rounded text-xs font-semibold ${m[t.type]}`,children:t.type})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Message:"}),e.jsx("p",{className:"bg-gray-100 p-3 rounded border mt-1",children:t.message})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Status:"})," ",t.status]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Date:"})," ",new Date(t.created_at).toLocaleString()]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx(n,{variant:"outline",onClick:()=>c(!1),children:"Close"})})]})]})})]})}export{he as default};
