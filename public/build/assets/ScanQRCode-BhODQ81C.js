import{r as t,j as e,a as u}from"./app-Dp8eBqIU.js";import{F as f,z as o}from"./index-DBS4BxWO.js";import{B as g}from"./button-B99OZixS.js";import{A as S}from"./app-layout-DQ7AMV3P.js";import"./app-BLU9PWWC.js";import"./utils-BJ1vGYlN.js";import"./clsx-B-dksMZM.js";import"./index-0TQvwkXz.js";import"./index-D-XRdT2p.js";import"./index-5JiLXXvR.js";import"./index-DCCk8fkd.js";import"./x-CosRwlaN.js";import"./createLucideIcon-BgI95zP9.js";import"./index-DSd_tBaf.js";import"./chevron-down-BkXCBmR0.js";import"./index-Z07DRefU.js";import"./index-CDy59-5j.js";import"./index-CMWG4mbA.js";import"./log-out-BJ7NbZjK.js";import"./users-C4xSFfJR.js";import"./map-pin-vjPQ7KjQ.js";import"./file-text-CLxDmEOh.js";import"./clipboard-list-Czd-FXhb.js";import"./settings-dOOLNFQc.js";const j=require("react-qr-scanner").default;function K(){const[a,n]=t.useState(null),[m,c]=t.useState(!0),[d,i]=t.useState(!1),p=async r=>{if(r&&m){const l=r.text||r;n(l),c(!1),i(!0);try{const s=await u.post(`/documentrequests/release/${l}`);o.success(s.data.message||"Document successfully released!")}catch(s){console.error("QR Scan Error:",s),o.error(s.response?.data?.message||"Failed to release document.")}finally{i(!1)}}},x=r=>{console.error("QR Scanner Error:",r),o.error("Camera access failed. Please allow permissions.")},h=()=>{n(null),c(!0)};return e.jsxs(S,{breadcrumbs:[{title:"Scan QR Code",href:"/scan-qr"}],children:[e.jsx(f,{position:"top-right"}),e.jsxs("div",{className:"flex flex-col items-center mt-10 space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-green-700",children:"Scan QR Code to Release Document"}),e.jsx("div",{className:"border-4 border-green-600 rounded-xl overflow-hidden w-[320px] h-[240px]",children:e.jsx(j,{delay:300,onError:x,onScan:p,style:{width:"100%",height:"100%"}})}),d?e.jsx("p",{className:"text-gray-600 mt-2",children:"Processing..."}):a?e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-gray-700",children:[e.jsx("strong",{children:"QR Token:"})," ",a]}),e.jsx(g,{className:"mt-3 bg-green-700",onClick:h,children:"Scan Another"})]}):e.jsx("p",{className:"text-gray-500 mt-2",children:"Align the QR code inside the box"})]})]})}export{K as default};
