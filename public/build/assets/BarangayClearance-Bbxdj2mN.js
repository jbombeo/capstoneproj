import{u as Q,r as t,j as e,H as M,a as k}from"./app-Dp8eBqIU.js";import{A as O}from"./app-layout-DQ7AMV3P.js";import{T as F,a as z,b as u,c as m,d as H,e as l}from"./table-BZxq2vlU.js";import{B as K}from"./button-B99OZixS.js";import{I as A}from"./input-BPBq9ODa.js";import{F as E,z as c}from"./index-DBS4BxWO.js";import{Q as U,a as W}from"./QRScannerModal-DdnwjGBf.js";import{c as P}from"./createLucideIcon-BgI95zP9.js";import{C as G}from"./clock-CiK9ampk.js";import{P as V}from"./package-check-BdWcsfOE.js";import{C as Y}from"./circle-check-big-UzuGCamm.js";import"./app-BLU9PWWC.js";import"./utils-BJ1vGYlN.js";import"./clsx-B-dksMZM.js";import"./index-0TQvwkXz.js";import"./index-D-XRdT2p.js";import"./index-5JiLXXvR.js";import"./index-DCCk8fkd.js";import"./x-CosRwlaN.js";import"./index-DSd_tBaf.js";import"./chevron-down-BkXCBmR0.js";import"./index-Z07DRefU.js";import"./index-CDy59-5j.js";import"./index-CMWG4mbA.js";import"./log-out-BJ7NbZjK.js";import"./users-C4xSFfJR.js";import"./map-pin-vjPQ7KjQ.js";import"./file-text-CLxDmEOh.js";import"./clipboard-list-Czd-FXhb.js";import"./settings-dOOLNFQc.js";import"./dialog-CbfhkJXM.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],X=P("Printer",J);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],q=P("RotateCcw",Z),ee=a=>{if(a>3&&a<21)return`${a}th`;switch(a%10){case 1:return`${a}st`;case 2:return`${a}nd`;case 3:return`${a}rd`;default:return`${a}th`}};function $e(){const{props:a}=Q(),[R,g]=t.useState(a.clearances||[]),[r]=t.useState(a.officials||[]),[f,_]=t.useState(""),[n,j]=t.useState(null),[p,y]=t.useState(!1),[T,b]=t.useState(!1),h=new Date,$=`${ee(h.getDate())} of ${h.toLocaleDateString("en-US",{month:"long"})}, ${h.getFullYear()}`,o=r.find(s=>s.position==="Punong Barangay"),N=r.filter(s=>s.position==="Barangay Kagawad"),w=r.find(s=>s.position==="SK Chairman"),v=r.find(s=>["Secretary","Barangay Secretary"].includes(s.position)),C=r.find(s=>["Treasurer","Barangay Treasurer"].includes(s.position)),D=async s=>{try{await k.post(`/documentrequests/release/${s}`),g(d=>d.map(i=>i.qr_token===s?{...i,status:"released"}:i)),c.success("Document status updated to Released!")}catch{c.error("Failed to release document. Invalid QR code?")}},S=async(s,d=!1)=>{j(s),setTimeout(async()=>{if(!p){y(!0);try{if(!d&&s.status==="on process"){const i=await k.put(`/documentrequests/${s.id}/ready`);g(I=>I.map(x=>x.id===s.id?{...x,status:"ready for pick-up"}:x)),c.success(i.data.message||"Document marked Ready for Pick-up!")}else d&&c.success("Reprinting document...")}catch{c.error("Failed to update document status.")}finally{y(!1)}window.print(),j(null)}},200)},B=R.filter(s=>`${s.resident.first_name} ${s.resident.last_name}`.toLowerCase().includes(f.toLowerCase())),L=s=>s?`${window.location.origin}/documentrequests/release/${s}`:"";return e.jsxs(O,{breadcrumbs:[{title:"Barangay Clearance",href:"/barangay-clearance"}],children:[e.jsx(M,{title:"Barangay Clearance"}),e.jsx(E,{position:"top-right"}),e.jsxs("div",{className:"flex justify-between items-center mb-8 bg-green-600 text-white shadow p-6 rounded-lg",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Barangay Clearance Requests"}),e.jsx(K,{onClick:()=>b(!0),className:"bg-white text-green-700 hover:bg-green-100",children:"Scan QR Code"})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(A,{placeholder:"Search by resident name...",value:f,onChange:s=>_(s.target.value),className:"max-w-sm mb-4"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(F,{children:[e.jsx(z,{children:e.jsxs(u,{children:[e.jsx(m,{children:"Name"}),e.jsx(m,{children:"Purpose"}),e.jsx(m,{children:"Status"}),e.jsx(m,{children:"Action"})]})}),e.jsx(H,{children:B.length?B.map(s=>e.jsxs(u,{children:[e.jsxs(l,{children:[s.resident.first_name," ",s.resident.last_name]}),e.jsx(l,{children:s.purpose}),e.jsx(l,{className:"capitalize",children:s.status}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.status==="on process"&&e.jsx("button",{title:"Print","aria-label":"Print",onClick:()=>S(s),className:"p-2 rounded-md hover:bg-gray-100",disabled:p,children:e.jsx(X,{className:"h-5 w-5 text-blue-600"})}),(s.status==="ready for pick-up"||s.status==="released")&&e.jsx("button",{title:"Reprint","aria-label":"Reprint",onClick:()=>S(s,!0),className:"p-2 rounded-md hover:bg-gray-100",disabled:p,children:e.jsx(q,{className:"h-5 w-5 text-orange-500"})}),s.status==="pending"&&e.jsx("div",{title:"Pending",className:"p-2 rounded-md bg-yellow-50",children:e.jsx(G,{className:"h-5 w-5 text-yellow-600"})}),s.status==="ready for pick-up"&&e.jsx("div",{title:"Ready for pick-up",className:"p-2 rounded-md bg-teal-50",children:e.jsx(V,{className:"h-5 w-5 text-teal-600"})}),s.status==="released"&&e.jsx("div",{title:"Released",className:"p-2 rounded-md bg-green-50",children:e.jsx(Y,{className:"h-5 w-5 text-green-600"})})]})})]},s.id)):e.jsx(u,{children:e.jsx(l,{colSpan:4,className:"text-center text-gray-500",children:"No Barangay Clearance requests found."})})})]})})]}),e.jsx(U,{open:T,onClose:()=>b(!1),onScanSuccess:D}),n&&e.jsxs("div",{id:"print-area",className:"hidden print:block relative bg-white text-black leading-relaxed",style:{width:"185mm",height:"270mm",padding:"10mm",border:"10px solid #1B5E20",fontFamily:"'Times New Roman', serif"},children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("img",{src:"/images/logo.png",alt:"Left Logo",className:"w-20 h-20"}),e.jsxs("div",{children:[e.jsx("p",{children:"Republic of the Philippines"}),e.jsx("p",{children:"Province of Misamis Oriental"}),e.jsx("p",{children:"City of Cagayan de Oro"}),e.jsx("p",{className:"font-bold uppercase text-green-800",children:"Barangay Iponan"})]}),e.jsx("img",{src:"/images/cdologo.png",alt:"Right Logo",className:"w-20 h-20"})]}),e.jsx("h2",{className:"mt-4 font-bold text-lg uppercase text-green-700",children:"Office of the Punong Barangay"}),e.jsx("hr",{className:"border-green-700 my-2"}),e.jsx("h1",{className:"text-3xl font-bold underline uppercase text-green-900",children:"Barangay Clearance"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-6 mt-10",children:[e.jsxs("div",{className:"col-span-1 text-sm p-4 border border-green-700 rounded-lg bg-green-100 shadow",children:[e.jsx("h2",{className:"font-bold text-green-800 text-center mb-4 text-base",children:"Barangay Officials"}),o&&e.jsxs("p",{className:"font-bold",children:[o.complete_name,e.jsx("br",{}),"Punong Barangay"]}),N.length>0&&e.jsx("p",{className:"underline",children:"Barangay Kagawad"}),e.jsx("ul",{className:"ml-2 mb-3 list-disc list-inside",children:N.map(s=>e.jsx("li",{children:s.complete_name},s.id))}),w&&e.jsxs("p",{className:"mt-2 font-bold",children:[w.complete_name,e.jsx("br",{}),"SK Chairman"]}),v&&e.jsxs("p",{className:"mt-3 font-bold",children:[v.complete_name,e.jsx("br",{}),"Secretary"]}),C&&e.jsxs("p",{className:"mt-3 font-bold",children:[C.complete_name,e.jsx("br",{}),"Treasurer"]})]}),e.jsxs("div",{className:"col-span-2 text-justify text-[15px] relative pl-6",children:[e.jsx("div",{className:"absolute inset-y-0 right-0 opacity-10 flex items-center pr-10",children:e.jsx("img",{src:"/images/logo.png",alt:"Watermark",className:"w-80 h-80"})}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("p",{children:["This is to certify that"," ",e.jsxs("span",{className:"font-bold underline",children:[n.resident.first_name," ",n.resident.last_name]})," ","residing at Barangay Iponan, Cagayan de Oro City, is a bona fide resident of this barangay."]}),e.jsxs("p",{className:"mt-4",children:["This certification is issued upon request for the purpose of"," ",e.jsx("span",{className:"font-bold underline",children:n.purpose}),"."]}),e.jsxs("p",{className:"mt-4",children:["Given this ",e.jsx("span",{className:"underline",children:$})," at Barangay Iponan, Cagayan de Oro City, Misamis Oriental."]}),o&&e.jsxs("div",{className:"mt-16 text-right pr-16",children:[e.jsx("p",{className:"font-bold uppercase text-green-900",children:o.complete_name}),e.jsx("p",{children:"Punong Barangay"})]}),e.jsx("div",{className:"flex justify-center mt-8",children:e.jsx(W,{value:L(n.qr_token),size:120})}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Scan QR code to verify release status"})]})]})]}),e.jsx("div",{className:"absolute bottom-10 left-0 right-0 text-center",children:e.jsx("p",{className:"text-green-800 font-bold uppercase tracking-wider text-lg",children:"Certified True Copy"})})]})]})}export{$e as default};
