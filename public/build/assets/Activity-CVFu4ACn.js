import{u as L,r as h,j as e,H as T,a as y}from"./app-pOO083-e.js";import{A as z}from"./app-layout-Dc3hkrhW.js";import{I as g}from"./input-BNUIgu_-.js";import{B as o}from"./button-C04eTuKF.js";import{C as _,a as $}from"./card-7timp76z.js";import{D as b,a as H,b as D,c as E,d as F,e as S}from"./dialog-C6812wCE.js";import{L as u}from"./label-C_a1iMIs.js";import{F as R,z as x}from"./index-CJOt3l_0.js";import{I as j}from"./input-error-DvaupZEU.js";import{S as B}from"./square-pen-4rt6s-Wq.js";import{T as q}from"./trash-CHDqI7I9.js";/* empty css            */import"./app-sidebar-header-COL4hiO2.js";import"./createLucideIcon-DoMVaiJs.js";import"./index-D3C--ds9.js";import"./index-hFgQNbVr.js";import"./index-BvNCmLem.js";import"./index-DwhOcVGB.js";import"./log-out-02q7rZj1.js";import"./x-C-J8wUVu.js";import"./index-D0bkFEMS.js";import"./settings-BYB2_0H7.js";import"./file-text-pZ84JjBm.js";function he({activities:n}){const{errors:d}=L().props,[v,p]=h.useState(!1),[l,s]=h.useState(!1),[i,A]=h.useState(null),[a,m]=h.useState({dateofactivity:"",activity:"",description:"",photos:[]}),[N,f]=h.useState([]),w=()=>{m({dateofactivity:"",activity:"",description:"",photos:[]}),f([])},C=t=>{if(!t.target.files)return;const r=Array.from(t.target.files);m(c=>({...c,photos:r})),f(r.map(c=>URL.createObjectURL(c)))},k=()=>{const t=new FormData;t.append("dateofactivity",a.dateofactivity),t.append("activity",a.activity),t.append("description",a.description),a.photos.forEach((r,c)=>t.append(`photos[${c}]`,r)),y.post("/activities",t,{forceFormData:!0,onSuccess:()=>{w(),p(!1),x.success("Activity added successfully!")},onError:()=>x.error("Failed to add activity")})},O=t=>{A(t),m({dateofactivity:t.dateofactivity,activity:t.activity,description:t.description,photos:[]}),f([]),s(!0)},P=()=>{if(!i)return;const t=new FormData;t.append("dateofactivity",a.dateofactivity),t.append("activity",a.activity),t.append("description",a.description),t.append("_method","PUT"),a.photos.forEach((r,c)=>t.append(`photos[${c}]`,r)),y.post(`/activities/${i.id}`,t,{forceFormData:!0,onSuccess:()=>{w(),A(null),s(!1),x.success("Activity updated successfully!")},onError:()=>x.error("Failed to update activity")})},I=t=>{confirm("Are you sure you want to delete this activity?")&&y.delete(`/activities/${t}`,{onSuccess:()=>x.success("Activity deleted successfully!")})};return e.jsxs(z,{breadcrumbs:[{title:"Activities",href:"#"}],children:[e.jsx(T,{title:"Activities"}),e.jsx(R,{}),e.jsxs("div",{className:"flex justify-between items-center mb-8 bg-green-600 text-white shadow p-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Activities"}),e.jsxs(b,{open:v,onOpenChange:p,children:[e.jsx(H,{asChild:!0,children:e.jsx(o,{className:"bg-blue-600 hover:bg-blue-700",children:"+ Add Activity"})}),e.jsxs(D,{className:"sm:max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs(E,{children:[e.jsx(F,{children:"Add Activity"}),e.jsx(S,{children:"Fill in the details below to create a new activity."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(U,{formData:a,setFormData:m,previewUrls:N,handleFileChange:C,errors:d}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(o,{variant:"outline",onClick:()=>p(!1),children:"Cancel"}),e.jsx(o,{onClick:k,children:"Save"})]})]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.length>0?n.map(t=>e.jsx(_,{className:"shadow rounded-xl",children:e.jsxs($,{className:"p-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:t.activity}),e.jsx("p",{className:"text-sm text-gray-600",children:t.dateofactivity}),e.jsx("p",{children:t.description})]}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:t.activity_photos.length>0?t.activity_photos.map(r=>e.jsx("img",{src:r.url,alt:"Activity",className:"w-24 h-24 object-cover rounded",crossOrigin:"use-credentials"},r.id)):e.jsx("div",{className:"w-24 h-24 bg-gray-200 flex items-center justify-center rounded",children:e.jsx("span",{className:"text-gray-500 text-sm",children:"No Image"})})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(o,{size:"sm",variant:"outline",onClick:()=>O(t),children:[e.jsx(B,{className:"w-4 h-4 mr-1"})," Edit"]}),e.jsxs(o,{size:"sm",variant:"destructive",onClick:()=>I(t.id),children:[e.jsx(q,{className:"w-4 h-4 mr-1"})," Delete"]})]})]})},t.id)):e.jsx("p",{className:"text-gray-500",children:"No activities found"})}),e.jsx(b,{open:l,onOpenChange:s,children:e.jsxs(D,{className:"sm:max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs(E,{children:[e.jsx(F,{children:"Edit Activity"}),e.jsx(S,{children:"Update the details of your activity below."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(U,{formData:a,setFormData:m,previewUrls:N,handleFileChange:C,errors:d}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(o,{variant:"outline",onClick:()=>s(!1),children:"Cancel"}),e.jsx(o,{onClick:P,children:"Update"})]})]})]})})]})}function U({formData:n,setFormData:d,previewUrls:v,handleFileChange:p,errors:l}){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(u,{children:"Date of Activity"}),e.jsx(g,{type:"date",value:n.dateofactivity,onChange:s=>d(i=>({...i,dateofactivity:s.target.value}))}),e.jsx(j,{message:l.dateofactivity})]}),e.jsxs("div",{children:[e.jsx(u,{children:"Activity"}),e.jsx(g,{value:n.activity,onChange:s=>d(i=>({...i,activity:s.target.value}))}),e.jsx(j,{message:l.activity})]}),e.jsxs("div",{children:[e.jsx(u,{children:"Description"}),e.jsx("textarea",{className:"w-full border rounded p-2 focus:ring",rows:4,value:n.description,onChange:s=>d(i=>({...i,description:s.target.value}))}),e.jsx(j,{message:l.description})]}),e.jsxs("div",{children:[e.jsx(u,{children:"Upload Photos"}),e.jsx(g,{type:"file",multiple:!0,onChange:p}),e.jsx(j,{message:l.photos}),v.length>0&&e.jsx("div",{className:"grid grid-cols-3 gap-3 mt-2",children:v.map((s,i)=>e.jsx("img",{src:s,className:"w-24 h-24 object-cover rounded"},i))})]})]})}export{he as default};
