import{u as K,r as c,j as e,H as Q,b as f}from"./app-XOPTMjug.js";import{A as W}from"./app-layout-BmXM_f4V.js";import{I as d}from"./input-BbyJlRcP.js";import{B as r}from"./button-D5dj0b15.js";import{C as X,a as Z}from"./card-BuULeum6.js";import{D as S,e as ee,a as w,b,c as B}from"./dialog-VZV5TY4s.js";import{L as o}from"./label-Dj8APtd9.js";import{F as te,z as h}from"./index-iTk-9HXW.js";import"./app-nfuc1qUJ.js";import"./utils-BAltloCr.js";import"./clsx-B-dksMZM.js";import"./index-Bw5zOxMT.js";import"./index-CVjkNEJV.js";import"./index-BhjRGQ5V.js";import"./index-Cdce5v5G.js";import"./x-Bv1O4pW9.js";import"./createLucideIcon-Bv13kPL-.js";import"./index-BEQwaIHq.js";import"./chevron-down-Vwy7lRkv.js";import"./index-BnwXxOQs.js";import"./index-CDy59-5j.js";import"./index-CMWG4mbA.js";import"./log-out-CUpKvNT0.js";import"./users-DEeIWw72.js";import"./map-pin-XXaN1Jig.js";import"./file-text-D9QnVhaT.js";import"./clipboard-list-D2hxFQXo.js";import"./settings-BxToKCzk.js";const E=({formData:i,setFormData:n,onSubmit:_,onCancel:m,submitLabel:N})=>e.jsxs("div",{className:"space-y-4",children:[[["complainant","Complainant"],["complainant_address","Complainant Address"],["complainee","Complainee"],["complainee_address","Complainee Address"],["complaint","Complaint"],["action","Action"],["incidence","Incidence"],["handled_by","Handled By"]].map(([a,s])=>e.jsxs("div",{children:[e.jsx(o,{htmlFor:a,children:s}),e.jsx(d,{id:a,value:i[a],onChange:y=>n(p=>({...p,[a]:y.target.value}))})]},a)),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(o,{htmlFor:"complainant_age",children:"Complainant Age"}),e.jsx(d,{id:"complainant_age",type:"number",value:i.complainant_age,onChange:a=>n(s=>({...s,complainant_age:a.target.value}))})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(o,{htmlFor:"complainant_contact",children:"Complainant Contact"}),e.jsx(d,{id:"complainant_contact",value:i.complainant_contact,onChange:a=>n(s=>({...s,complainant_contact:a.target.value}))})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(o,{htmlFor:"complainee_age",children:"Complainee Age"}),e.jsx(d,{id:"complainee_age",type:"number",value:i.complainee_age,onChange:a=>n(s=>({...s,complainee_age:a.target.value}))})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(o,{htmlFor:"complainee_contact",children:"Complainee Contact"}),e.jsx(d,{id:"complainee_contact",value:i.complainee_contact,onChange:a=>n(s=>({...s,complainee_contact:a.target.value}))})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"status",children:"Status"}),e.jsxs("select",{id:"status",value:i.status,onChange:a=>n(s=>({...s,status:a.target.value})),className:"border rounded px-2 py-1 w-full",children:[e.jsx("option",{value:"unsettled",children:"Unsettled"}),e.jsx("option",{value:"settled",children:"Settled"}),e.jsx("option",{value:"scheduled",children:"Scheduled"})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"incident_datetime",children:"Incident Date & Time"}),e.jsx(d,{id:"incident_datetime",type:"datetime-local",value:i.incident_datetime,onChange:a=>n(s=>({...s,incident_datetime:a.target.value}))})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(r,{variant:"outline",onClick:m,children:"Cancel"}),e.jsx(r,{onClick:_,children:N})]})]});function Fe(){const{blotters:i}=K().props,[n,_]=c.useState(""),[m,N]=c.useState(""),[a,s]=c.useState(""),[y,p]=c.useState(!1),[D,u]=c.useState(!1),[I,C]=c.useState(!1),[A,O]=c.useState(null),[F,Y]=c.useState(null),[j,g]=c.useState({complainant:"",complainant_address:"",complainant_age:"",complainant_contact:"",complainee:"",complainee_address:"",complainee_age:"",complainee_contact:"",complaint:"",status:"unsettled",action:"",incidence:"",handled_by:"",incident_datetime:new Date().toISOString().slice(0,16)}),L=()=>{g({complainant:"",complainant_address:"",complainant_age:"",complainant_contact:"",complainee:"",complainee_address:"",complainee_age:"",complainee_contact:"",complaint:"",status:"unsettled",action:"",incidence:"",handled_by:"",incident_datetime:new Date().toISOString().slice(0,16)})},z=()=>{f.post("/blotters",j,{onSuccess:()=>{L(),p(!1),h.success("Blotter added successfully!")}})},U=t=>{O(t),g({complainant:t.complainant,complainant_address:t.complainant_address??"",complainant_age:t.complainant_age?.toString()??"",complainant_contact:t.complainant_contact??"",complainee:t.complainee,complainee_address:t.complainee_address??"",complainee_age:t.complainee_age?.toString()??"",complainee_contact:t.complainee_contact??"",complaint:t.complaint,status:t.status,action:t.action??"",incidence:t.incidence??"",handled_by:t.handled_by??"",incident_datetime:t.incident_datetime??new Date().toISOString().slice(0,16)}),u(!0)},V=t=>{Y(t),C(!0)},H=()=>{A&&f.put(`/blotters/${A.id}`,j,{onSuccess:()=>{u(!1),O(null),L(),h.success("Blotter updated successfully!")}})},M=t=>{confirm("Are you sure you want to delete this blotter?")&&f.delete(`/blotters/${t}`,{onSuccess:()=>h.error("Blotter deleted successfully!")})},T={unsettled:"bg-red-200 text-red-800",settled:"bg-green-200 text-green-800",scheduled:"bg-blue-200 text-blue-800"},x=i.filter(t=>{const l=t.complainant.toLowerCase().includes(n.toLowerCase())||t.complainee.toLowerCase().includes(n.toLowerCase()),v=t.incident_datetime?new Date(t.incident_datetime):null,G=m?v?.getMonth()===Number(m)-1:!0,J=a?v?.getFullYear()===Number(a):!0;return l&&G&&J}),$=new Date().getFullYear(),P=Array.from({length:10},(t,l)=>($-l).toString()),k=x.filter(t=>t.status==="unsettled").length,R=x.filter(t=>t.status==="settled").length,q=x.filter(t=>t.status==="scheduled").length;return e.jsxs(W,{breadcrumbs:[{title:"Blotters",href:"#"}],children:[e.jsx(Q,{title:"Blotters"}),e.jsx(te,{}),e.jsx("div",{className:"flex justify-between items-center mb-8 bg-green-600 text-white shadow-lg p-6",children:e.jsx("h1",{className:"text-3xl font-bold",children:"Blotters List"})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-6",children:[e.jsx(d,{placeholder:"Search by complainant or complainee...",value:n,onChange:t=>_(t.target.value),className:"flex-1 min-w-[200px]"}),e.jsxs("select",{className:"border rounded px-2 py-1",value:m,onChange:t=>N(t.target.value),children:[e.jsx("option",{value:"",children:"All Months"}),Array.from({length:12},(t,l)=>e.jsx("option",{value:(l+1).toString().padStart(2,"0"),children:new Date(0,l).toLocaleString("default",{month:"long"})},l+1))]}),e.jsxs("select",{className:"border rounded px-2 py-1",value:a,onChange:t=>s(t.target.value),children:[e.jsx("option",{value:"",children:"All Years"}),P.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs(S,{open:y,onOpenChange:p,children:[e.jsx(ee,{asChild:!0,children:e.jsx(r,{className:"bg-blue-600 text-white hover:bg-blue-700 ml-auto whitespace-nowrap",children:"+ Add Blotter"})}),e.jsxs(w,{className:"sm:max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsx(b,{children:e.jsx(B,{children:"Add Blotter"})}),e.jsx(E,{formData:j,setFormData:g,onSubmit:z,onCancel:()=>p(!1),submitLabel:"Add"})]})]})]}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsxs("div",{className:"flex-1 bg-red-100 text-red-800 rounded-lg shadow p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:k}),e.jsx("div",{children:"Unsettled"})]}),e.jsxs("div",{className:"flex-1 bg-green-100 text-green-800 rounded-lg shadow p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:R}),e.jsx("div",{children:"Settled"})]}),e.jsxs("div",{className:"flex-1 bg-blue-100 text-blue-800 rounded-lg shadow p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:q}),e.jsx("div",{children:"Scheduled"})]})]}),e.jsx(X,{className:"shadow-md rounded-2xl overflow-x-auto",children:e.jsx(Z,{className:"p-4",children:e.jsx("div",{className:"overflow-y-auto max-h-[400px]",children:e.jsxs("table",{className:"w-full text-sm text-left border-collapse",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 uppercase text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2",children:"Complainant"}),e.jsx("th",{className:"px-4 py-2",children:"Complainee"}),e.jsx("th",{className:"px-4 py-2",children:"Complaint"}),e.jsx("th",{className:"px-4 py-2",children:"Status"}),e.jsx("th",{className:"px-4 py-2",children:"Handled By"}),e.jsx("th",{className:"px-4 py-2",children:"Incident Date"}),e.jsx("th",{className:"px-4 py-2",children:"Action"}),e.jsx("th",{className:"px-4 py-2",children:"Options"})]})}),e.jsx("tbody",{children:x.length>0?x.map(t=>e.jsxs("tr",{className:"border-b hover:bg-gray-50 transition",children:[e.jsx("td",{className:"px-4 py-2",children:t.complainant}),e.jsx("td",{className:"px-4 py-2",children:t.complainee}),e.jsx("td",{className:"px-4 py-2",children:t.complaint}),e.jsx("td",{className:"px-4 py-2 text-center",children:e.jsxs("select",{value:t.status,onChange:l=>{const v=l.target.value;f.put(`/blotters/${t.id}`,{...t,status:v},{preserveScroll:!0,onSuccess:()=>h.success("Status updated!"),onError:()=>h.error("Failed to update status")})},className:`px-2 py-1 rounded-lg font-semibold text-center border ${T[t.status]}`,children:[e.jsx("option",{value:"unsettled",children:"Unsettled"}),e.jsx("option",{value:"settled",children:"Settled"}),e.jsx("option",{value:"scheduled",children:"Scheduled"})]})}),e.jsx("td",{className:"px-4 py-2",children:t.handled_by}),e.jsx("td",{className:"px-4 py-2",children:t.incident_datetime?.slice(0,16).replace("T"," ")}),e.jsx("td",{className:"px-4 py-2",children:t.action}),e.jsxs("td",{className:"px-4 py-2 flex gap-2",children:[e.jsx(r,{size:"sm",variant:"secondary",onClick:()=>V(t),children:"View"}),e.jsx(r,{size:"sm",onClick:()=>U(t),children:"Edit"}),e.jsx(r,{size:"sm",variant:"destructive",onClick:()=>M(t.id),children:"Delete"})]})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"text-center py-4 text-gray-500",children:"No records found"})})})]})})})}),e.jsx(S,{open:I,onOpenChange:C,children:e.jsxs(w,{className:"sm:max-w-lg max-h-[80vh] overflow-y-auto",children:[e.jsx(b,{children:e.jsx(B,{children:"View Blotter Details"})}),F&&e.jsxs("div",{className:"space-y-3",children:[Object.entries(F).map(([t,l])=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"font-semibold capitalize",children:[t.replaceAll("_"," "),":"]}),e.jsx("span",{className:"text-gray-700",children:l?.toString()||"â€”"})]},t)),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx(r,{variant:"outline",onClick:()=>C(!1),children:"Close"})})]})]})}),e.jsx(S,{open:D,onOpenChange:u,children:e.jsxs(w,{className:"sm:max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsx(b,{children:e.jsx(B,{children:"Edit Blotter"})}),e.jsx(E,{formData:j,setFormData:g,onSubmit:H,onCancel:()=>u(!1),submitLabel:"Update"})]})})]})}export{Fe as default};
