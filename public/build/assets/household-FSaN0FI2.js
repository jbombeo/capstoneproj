import{u as A,r as a,j as e,H as E,a as c}from"./app-BYDD7jqK.js";import{A as L}from"./app-layout-DwJpk70a.js";import{I as d}from"./input-iCoYWyDm.js";import{B as r}from"./button-Dr-gN8dc.js";import{C as k,a as $}from"./card-JB1H8R4P.js";import{D as b,a as M,b as g,c as y,d as _,f as N}from"./dialog-A7zjs0bz.js";import{L as i}from"./label-CHedX6Vx.js";import{z as m,F as B}from"./index-BhTkidEM.js";/* empty css            */import"./app-sidebar-header-p_ZutQgq.js";import"./createLucideIcon-DdLpzc9k.js";import"./index-B2jg6ky-.js";import"./index-CoyH5QwD.js";import"./index-WOlHJoPy.js";import"./index-DwhOcVGB.js";import"./log-out-Be8tPfcd.js";import"./x-JC7lT9T1.js";import"./index-fql2wrXq.js";import"./settings-D0VBnQjg.js";import"./file-text-BVrqHHw0.js";function te(){const{households:v,heads:H,errors:n,flash:t}=A().props,[u,w]=a.useState(""),[C,x]=a.useState(!1),[S,h]=a.useState(!1),[p,j]=a.useState(null),[o,l]=a.useState({household_no:"",household_member:"1",head_of_family:""});a.useEffect(()=>{n&&Object.keys(n).length>0&&Object.values(n).forEach(s=>m.error(s)),t?.success&&m.success(t.success),t?.error&&m.error(t.error)},[n,t]);const f=v.filter(s=>`${s.headOfFamily?.first_name} ${s.headOfFamily?.last_name}`.toLowerCase().includes(u.toLowerCase())),F=()=>{c.post("/households",o,{onSuccess:()=>{l({household_no:"",household_member:"1",head_of_family:""}),x(!1)}})},O=s=>{j(s),l({household_no:String(s.household_no),household_member:String(s.household_member),head_of_family:String(s.headOfFamily?.id??"")}),h(!0)},z=()=>{p&&c.put(`/households/${p.id}`,{household_no:o.household_no,household_member:o.household_member},{onSuccess:()=>{h(!1),j(null)}})},D=s=>{confirm("Are you sure you want to delete this household?")&&c.delete(`/households/${s}`)};return e.jsxs(L,{breadcrumbs:[{title:"Households",href:"#"}],children:[e.jsx(E,{title:"Households"}),e.jsx(B,{position:"top-right"}),e.jsx("div",{className:"flex justify-between items-center mb-8 bg-green-600 text-white shadow-lg p-6",children:e.jsx("h1",{className:"text-3xl font-bold",children:"Households List"})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(d,{placeholder:"Search by head of family...",value:u,onChange:s=>w(s.target.value),className:"max-w-sm"}),e.jsxs(b,{open:C,onOpenChange:x,children:[e.jsx(M,{asChild:!0,children:e.jsx(r,{className:"bg-blue-600 text-white hover:bg-blue-700",children:"+ Add Household"})}),e.jsxs(g,{className:"sm:max-w-md",children:[e.jsx(y,{children:e.jsx(_,{children:"Add New Household"})}),e.jsxs("div",{className:"space-y-4 mt-2",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Household No"}),e.jsx(d,{value:o.household_no,onChange:s=>l({...o,household_no:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Household Members"}),e.jsx(d,{type:"number",value:o.household_member,onChange:s=>l({...o,household_member:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Head of Family"}),e.jsxs("select",{value:o.head_of_family,onChange:s=>l({...o,head_of_family:s.target.value}),className:"w-full border rounded-md p-2",children:[e.jsx("option",{value:"",children:"-- Select Head of Family --"}),H.map(s=>e.jsxs("option",{value:s.id,children:[s.last_name,", ",s.first_name," ",s.zone?`(${s.zone.zone})`:""]},s.id))]})]})]}),e.jsx(N,{className:"mt-4",children:e.jsx(r,{className:"w-full bg-blue-600 text-white hover:bg-blue-700",onClick:F,children:"Add Household"})})]})]})]}),e.jsx(k,{className:"shadow-md rounded-2xl overflow-x-auto",children:e.jsx($,{className:"p-4",children:e.jsxs("table",{className:"w-full text-sm text-left border-collapse",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 uppercase text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2",children:"Household No"}),e.jsx("th",{className:"px-4 py-2",children:"Members"}),e.jsx("th",{className:"px-4 py-2",children:"Zone"}),e.jsx("th",{className:"px-4 py-2",children:"Head of Family"}),e.jsx("th",{className:"px-4 py-2",children:"Action"})]})}),e.jsx("tbody",{children:f.length>0?f.map(s=>e.jsxs("tr",{className:"border-b hover:bg-gray-50 transition",children:[e.jsx("td",{className:"px-4 py-2",children:s.household_no}),e.jsx("td",{className:"px-4 py-2",children:s.household_member}),e.jsx("td",{className:"px-4 py-2",children:s.zone?.zone??s.headOfFamily?.zone?.zone??""}),e.jsxs("td",{className:"px-4 py-2",children:[s.headOfFamily?.last_name,","," ",s.headOfFamily?.first_name]}),e.jsxs("td",{className:"px-4 py-2 space-x-2",children:[e.jsx(r,{size:"sm",variant:"outline",onClick:()=>O(s),children:"Edit"}),e.jsx(r,{size:"sm",variant:"destructive",onClick:()=>D(s.id),children:"Delete"})]})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center py-4 text-gray-500",children:"No households found"})})})]})})})]}),e.jsx(b,{open:S,onOpenChange:h,children:e.jsxs(g,{className:"sm:max-w-md",children:[e.jsx(y,{children:e.jsx(_,{children:"Edit Household"})}),e.jsxs("div",{className:"space-y-4 mt-2",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Household No"}),e.jsx(d,{value:o.household_no,onChange:s=>l({...o,household_no:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Members"}),e.jsx(d,{type:"number",value:o.household_member,onChange:s=>l({...o,household_member:s.target.value})})]})]}),e.jsx(N,{className:"mt-4",children:e.jsx(r,{className:"w-full bg-blue-600 text-white hover:bg-blue-700",onClick:z,children:"Update Household"})})]})})]})}export{te as default};
