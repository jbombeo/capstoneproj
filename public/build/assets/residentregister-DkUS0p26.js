import{r as h,j as e,H as E,a as v}from"./app-pOO083-e.js";import{F as I,z as S}from"./index-CJOt3l_0.js";import{I as w}from"./input-error-DvaupZEU.js";import{B as f}from"./button-C04eTuKF.js";import{I as F}from"./input-BNUIgu_-.js";import{L as j}from"./label-C_a1iMIs.js";import{D as z,b as H,c as L,d as A,e as B}from"./dialog-C6812wCE.js";import{L as M}from"./loader-circle-CO9zZoEs.js";/* empty css            */import"./index-hFgQNbVr.js";import"./index-BvNCmLem.js";import"./index-D3C--ds9.js";import"./x-C-J8wUVu.js";import"./createLucideIcon-DoMVaiJs.js";function ae({zones:n}){const i={email:"",last_name:"",first_name:"",middle_name:"",birth_date:"",birth_place:"",age:"",zone_id:"",total_household:"1",relationto_head_of_family:"",civil_status:"",occupation:"",household_no:"",religion:"",nationality:"Filipino",gender:"",skills:"",remarks:"",image:null},[a,c]=h.useState(i),[m,g]=h.useState(!1),[t,d]=h.useState({}),[x,N]=h.useState(null),[D,p]=h.useState(!1),u=h.useMemo(()=>{if(!a.birth_date)return"";const s=new Date(a.birth_date),o=new Date;let b=o.getFullYear()-s.getFullYear();const C=o.getMonth()-s.getMonth();return(C<0||C===0&&o.getDate()<s.getDate())&&b--,b},[a.birth_date]);h.useEffect(()=>{u&&a.age!==u.toString()&&c(s=>({...s,age:u.toString()}))},[u]);const l=(s,o)=>{c(b=>({...b,[s]:o})),s==="image"&&o&&N(URL.createObjectURL(o))},k=["email","last_name","first_name","birth_date","zone_id","gender"],R=()=>{const s={};return k.forEach(o=>{a[o]||(s[o]="This field is required")}),d(s),Object.keys(s).length===0},O=s=>{s.preventDefault(),R()&&(g(!0),d({}),v.post("/resident/register",a,{forceFormData:!0,onSuccess:()=>{c(i),N(null),S.success("Registration submitted! Please wait for admin approval."),v.visit("/login")},onError:o=>{d(o),S.error("Failed to register. Please check the form.")},onFinish:()=>g(!1)}))},P=()=>{p(!1),v.visit("/")};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(E,{title:"Resident Registration"}),e.jsx(I,{position:"top-right",toastOptions:{duration:4e3}}),e.jsxs("header",{className:"fixed top-0 left-0 w-full z-50 bg-cover bg-center shadow-lg",style:{backgroundImage:"url('/images/iponan2.jpg')"},children:[e.jsx("div",{className:"absolute inset-0 bg-green-900 bg-opacity-70"}),e.jsxs("div",{className:"relative max-w-5xl mx-auto flex items-center justify-between px-6 py-3 md:py-6",children:[e.jsx("img",{src:"/images/logo.png",alt:"Barangay Logo",className:"h-12 w-12 md:h-20 md:w-20 rounded-full border-2 border-white shadow"}),e.jsxs("div",{className:"text-center text-white px-2",children:[e.jsx("h1",{className:"text-lg md:text-2xl font-bold uppercase",children:"Barangay Resident Registration"}),e.jsx("p",{className:"text-xs md:text-sm opacity-90 italic",children:"Official Government Service Portal"})]}),e.jsx("img",{src:"/images/cdologo.png",alt:"Gov Seal",className:"h-17 w-12 md:h-20 md:w-20 rounded-full border-white shadow"})]})]}),e.jsx("main",{className:"max-w-3xl mx-auto bg-white shadow-lg rounded-2xl border border-gray-200 p-8 pt-40 md:pt-56 space-y-8",children:e.jsxs("form",{onSubmit:O,encType:"multipart/form-data",className:"space-y-8",children:[e.jsx(_,{title:"Personal Information"}),e.jsxs("div",{className:"grid gap-6 sm:grid-cols-2",children:[e.jsx(r,{label:"Email Address *",name:"email",type:"email",value:a.email,onChange:l,error:t.email}),e.jsx(r,{label:"First Name *",name:"first_name",value:a.first_name,onChange:l,error:t.first_name}),e.jsx(r,{label:"Middle Name",name:"middle_name",value:a.middle_name,onChange:l,error:t.middle_name}),e.jsx(r,{label:"Last Name *",name:"last_name",value:a.last_name,onChange:l,error:t.last_name}),e.jsx(r,{label:"Birth Date *",name:"birth_date",type:"date",value:a.birth_date,onChange:l,error:t.birth_date}),e.jsx(r,{label:"Birth Place",name:"birth_place",value:a.birth_place,onChange:l,error:t.birth_place}),e.jsx(r,{label:"Religion",name:"religion",value:a.religion,onChange:l,error:t.religion}),e.jsx(r,{label:"Nationality",name:"nationality",value:a.nationality,onChange:l,error:t.nationality}),u&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{className:"font-medium",children:"Age"}),e.jsx("div",{className:"p-2 border rounded bg-gray-100 text-gray-700",children:u})]}),e.jsx(y,{label:"Zone *",name:"zone_id",value:a.zone_id,onChange:l,error:t.zone_id,options:n.map(s=>s.zone),optionValues:n.map(s=>s.id.toString())}),e.jsx(y,{label:"Gender *",name:"gender",value:a.gender,onChange:l,error:t.gender,options:["Male","Female","Other"]}),e.jsx(y,{label:"Civil Status *",name:"civil_status",value:a.civil_status,onChange:l,error:t.civil_status,options:["Single","Married","Widow","Other"]})]}),e.jsx(_,{title:"Household Information"}),e.jsxs("div",{className:"grid gap-6 sm:grid-cols-2",children:[e.jsx(r,{label:"Total Household",name:"total_household",type:"number",value:a.total_household,onChange:l,error:t.total_household}),e.jsx(r,{label:"Relation to Head of Family",name:"relationto_head_of_family",value:a.relationto_head_of_family,onChange:l,error:t.relationto_head_of_family}),e.jsx(r,{label:"Occupation",name:"occupation",value:a.occupation,onChange:l,error:t.occupation}),e.jsx(r,{label:"Household No",name:"household_no",value:a.household_no,onChange:l,error:t.household_no})]}),e.jsx(_,{title:"Additional Information"}),e.jsxs("div",{className:"grid gap-6 sm:grid-cols-2",children:[e.jsx(r,{label:"Skills",name:"skills",value:a.skills,onChange:l,error:t.skills}),e.jsx(r,{label:"Remarks",name:"remarks",value:a.remarks,onChange:l,error:t.remarks})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"image",className:"font-medium",children:"Upload Valid Photo"}),e.jsx(F,{id:"image",type:"file",accept:"image/*",onChange:s=>l("image",s.target.files?.[0]||null),className:"border rounded-lg p-2 bg-white"}),e.jsx(w,{message:t.image}),x&&e.jsx("img",{src:x,alt:"Preview",className:"w-28 h-28 mt-3 object-cover rounded-full border shadow"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mt-6",children:[e.jsxs(f,{type:"submit",disabled:m,className:"flex items-center justify-center w-full sm:w-auto py-3 px-8 text-white text-lg font-semibold rounded-lg shadow-md bg-blue-900 hover:bg-blue-800 transition-all",children:[m&&e.jsx(M,{className:"h-5 w-5 mr-2 animate-spin"}),m?"Submittingâ€¦":"Register"]}),e.jsx(f,{type:"button",onClick:()=>p(!0),className:"w-full sm:w-auto py-3 px-8 text-lg font-semibold rounded-lg shadow-md bg-red-600 hover:bg-red-700 text-white transition-all",children:"Cancel"})]})]})}),e.jsx(z,{open:D,onOpenChange:p,children:e.jsxs(H,{className:"sm:max-w-md",children:[e.jsxs(L,{children:[e.jsx(A,{className:"text-lg font-semibold text-gray-800",children:"Cancel Registration"}),e.jsx(B,{className:"text-sm text-gray-600",children:"Are you sure you want to cancel? All entered data will be lost."})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mt-6 justify-center",children:[e.jsx(f,{type:"button",onClick:()=>p(!1),className:"w-full sm:w-auto px-8 py-2.5 text-sm font-semibold rounded-lg shadow-md border border-gray-300 text-gray-700 bg-white hover:bg-gray-100 transition-all",children:"No, Stay Here"}),e.jsx(f,{type:"button",onClick:P,className:"w-full sm:w-auto px-8 py-2.5 text-sm font-semibold rounded-lg shadow-md bg-red-600 hover:bg-red-700 text-white transition-all",children:"Yes, Cancel"})]})]})})]})}function _({title:n}){return e.jsx("h2",{className:"text-xl font-semibold text-blue-900 border-b pb-2",children:n})}function r({label:n,name:i,type:a="text",value:c,onChange:m,error:g}){return e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:i,className:"font-medium",children:n}),e.jsx(F,{id:i,name:i,type:a,value:c,onChange:t=>m(i,t.target.value),className:"rounded-lg border-gray-300"}),g&&e.jsx(w,{message:g})]})}function y({label:n,name:i,value:a,onChange:c,error:m,options:g,optionValues:t}){return e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:i,className:"font-medium",children:n}),e.jsxs("select",{id:i,value:a,onChange:d=>c(i,d.target.value),className:"border rounded-lg p-2 bg-white",children:[e.jsxs("option",{value:"",children:["Select ",n]}),g.map((d,x)=>e.jsx("option",{value:t?t[x]:d,children:d},d))]}),m&&e.jsx(w,{message:m})]})}export{ae as default};
