import{u as S,r as i,j as e,H as R,a as _}from"./app-CHrjJv7C.js";import{A as D}from"./app-layout-DCiK010d.js";import{T as P,a as T,b as h,c as o,d as q,e as r}from"./table-CESz-7Pl.js";import{B as x}from"./button-B2odc3Mr.js";import{I as A}from"./input-CCRLN5kg.js";import{C as F}from"./circle-check-big-vnDm_P_G.js";import{C as L}from"./clock-C2ov9pb0.js";import{P as B}from"./package-check-B1DESOda.js";import{c as G}from"./createLucideIcon-r-04NXR0.js";import{C as H}from"./circle-x-xOJyD4ec.js";import"./app-B1aFYef8.js";import"./utils-DpkqiH3w.js";import"./clsx-B-dksMZM.js";import"./index-4up-H-0J.js";import"./index-DCA_c2uc.js";import"./index-C-wBWVm_.js";import"./index-5g6cmtIN.js";import"./x-6MjSoi9b.js";import"./index-BmrMFvkv.js";import"./chevron-down-Dus9dkDx.js";import"./index-BBMhhFRK.js";import"./index-CDy59-5j.js";import"./index-CMWG4mbA.js";import"./log-out-yjwyG8Ps.js";import"./users-sN_XFzBw.js";import"./map-pin-BOfusBn5.js";import"./file-text-Dy-rehNU.js";import"./clipboard-list-CeYPJHW-.js";import"./settings-DA-kq5U4.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]],$=G("CheckCheck",M);function je(){const{props:l}=S(),[g,j]=i.useState(l.requests||[]),[v]=i.useState(l.residents||[]),[d]=i.useState(l.documentTypes||[]),[f,N]=i.useState(""),[w,m]=i.useState(!1),[s,n]=i.useState({resident_id:"",document_type_id:0,purpose:"",payment_method:"cash",amount:"0",reference_number:""});i.useEffect(()=>{const t=d.find(a=>a.id===s.document_type_id);n(a=>({...a,amount:t?t.amount.toString():"0"}))},[s.document_type_id,d]);const b=t=>`â‚±${Number(t??0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`,C=async t=>{try{const c=(await _.put(`/documentrequests/${t.id}/accept`)).data.status;j(u=>u.map(p=>p.id===t.id?{...p,status:c}:p))}catch(a){console.error("Failed to accept request:",a),alert("Failed to accept request.")}},k=async t=>{if(t.preventDefault(),!s.resident_id)return alert("Please select a resident.");if(!s.document_type_id)return alert("Please select a document type.");if(!s.purpose.trim())return alert("Please enter a purpose.");if(s.payment_method==="gcash"&&!s.reference_number.trim())return alert("Please enter GCash reference number.");const a={resident_id:s.resident_id,document_type_id:s.document_type_id,purpose:s.purpose,payment_method:s.payment_method,amount:s.payment_method==="free"?0:Number(s.amount),reference_number:s.payment_method==="gcash"?s.reference_number:null};try{const c=await _.post("/documentrequests",a);j(u=>[...u,c.data]),n({resident_id:"",document_type_id:0,purpose:"",payment_method:"cash",amount:"0",reference_number:""}),m(!1)}catch(c){console.error("Failed to submit request:",c),alert(c.response?.data?.message||"Failed to submit request.")}},y=g.filter(t=>`${t.resident.first_name} ${t.resident.last_name}`.toLowerCase().includes(f.toLowerCase()));return e.jsxs(D,{breadcrumbs:[{title:"Document Requests",href:"/documentrequests"}],children:[e.jsx(R,{title:"Document Requests"}),e.jsxs("div",{className:"flex justify-between items-center items-center mb-10 bg-gradient-to-r from-blue-600 to-blue-300 text-white p-8  shadow-xl",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Document Requests"}),e.jsx(x,{onClick:()=>m(!0),children:"+ Request Document"})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(A,{placeholder:"Search by resident name...",value:f,onChange:t=>N(t.target.value),className:"max-w-sm mb-4"}),e.jsx("div",{className:"overflow-x-auto rounded-xl shadow",children:e.jsxs(P,{children:[e.jsx(T,{children:e.jsxs(h,{children:[e.jsx(o,{children:"Name"}),e.jsx(o,{children:"Document Type"}),e.jsx(o,{children:"Purpose"}),e.jsx(o,{children:"Payment"}),e.jsx(o,{children:"Amount"}),e.jsx(o,{children:"Status"}),e.jsx(o,{className:"text-center",children:"Action"})]})}),e.jsx(q,{children:y.length>0?y.map(t=>e.jsxs(h,{className:"hover:bg-gray-50",children:[e.jsxs(r,{children:[t.resident.first_name," ",t.resident.last_name]}),e.jsx(r,{children:t.document_type?.name}),e.jsx(r,{children:t.purpose}),e.jsx(r,{children:t.payments?.[0]?.payment_method??"N/A"}),e.jsx(r,{children:b(t.payments?.[0]?.amount??t.document_type?.amount)}),e.jsx(r,{className:"capitalize font-semibold",children:t.status}),e.jsx(r,{children:e.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[t.status==="pending"&&e.jsx("div",{title:"Accept Request",className:"cursor-pointer",onClick:()=>C(t),children:e.jsx(F,{className:"h-6 w-6 text-green-600 hover:text-green-800 transition"})}),t.status==="on process"&&e.jsx("div",{title:"Processing",children:e.jsx(L,{className:"h-6 w-6 text-gray-500"})}),t.status==="ready for pick-up"&&e.jsx("div",{title:"Ready for Pick-up",children:e.jsx(B,{className:"h-6 w-6 text-blue-600"})}),t.status==="released"&&e.jsx("div",{title:"Released",children:e.jsx($,{className:"h-6 w-6 text-green-600"})}),t.status==="declined"&&e.jsx("div",{title:"Declined",children:e.jsx(H,{className:"h-6 w-6 text-red-600"})})]})})]},t.id)):e.jsx(h,{children:e.jsx(r,{colSpan:7,className:"text-center py-4 text-gray-500",children:"No Document Requests found."})})})]})})]}),w&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md shadow-lg",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Request Document"}),e.jsxs("form",{onSubmit:k,className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Resident"}),e.jsxs("select",{className:"w-full border rounded p-2",value:s.resident_id,onChange:t=>n({...s,resident_id:t.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select Resident"}),v.map(t=>e.jsxs("option",{value:t.id,children:[t.first_name," ",t.last_name]},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Document Type"}),e.jsxs("select",{className:"w-full border rounded p-2",value:s.document_type_id,onChange:t=>n({...s,document_type_id:Number(t.target.value)}),required:!0,children:[e.jsx("option",{value:0,children:"Select Document Type"}),d.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Purpose"}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:s.purpose,onChange:t=>n({...s,purpose:t.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Payment Method"}),e.jsxs("select",{className:"w-full border rounded p-2",value:s.payment_method,onChange:t=>n({...s,payment_method:t.target.value}),children:[e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"gcash",children:"Gcash"}),e.jsx("option",{value:"free",children:"Free"})]})]}),s.payment_method!=="free"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Amount"}),e.jsx("input",{type:"text",className:"w-full border rounded p-2 bg-gray-100",value:b(s.amount),readOnly:!0})]}),s.payment_method==="gcash"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"GCash Reference Number"}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:s.reference_number,onChange:t=>n({...s,reference_number:t.target.value}),required:!0}),e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:"/images/gcash.jpg",alt:"GCash QR",className:"w-32 h-32 mx-auto"})})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[e.jsx(x,{type:"button",variant:"outline",onClick:()=>m(!1),children:"Cancel"}),e.jsx(x,{type:"submit",children:"Submit"})]})]})]})})]})}export{je as default};
